# Binary Search - ì´ë¶„íƒìƒ‰ ğŸ¿ï¸ğŸ’š

![Alt text](https://devopedia.org/images/article/28/2951.1490520804.gif)

### ì—°ìŠµ ë¬¸ì œ

- Binary Search : https://www.acmicpc.net/workbook/view/9764

- lower_bound, upper_bound : https://www.acmicpc.net/workbook/view/9264

<br>

## 1. ì‹œê°„ë³µì¡ë„

- ì´ë¶„íƒìƒ‰ì˜ ì‹œê°„ ë³µì¡ë„ëŠ” O(logN) ì´ë‹¤.
- ì—¬ê¸°ì„œ logëŠ” logâ‚‚ì´ë‹¤.
- ë‹¨ê³„ë§ˆë‹¤ íƒìƒ‰ ë²”ìœ„ë¥¼ ë°˜ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒê³¼ ê°™ë‹¤.

`â€» ì£¼ì˜ì‚¬í•­ : ì´ë¶„ íƒìƒ‰ì€ off-by-one error ê°€ ë°œìƒí•˜ê¸° ì‰¬ì›Œì„œ í—·ê°ˆë ¤ìš”!`

    â†’ íƒˆì¶œ ì¡°ê±´ìœ¼ë¡œ lo <= hi, lo < hi, lo + 1 < hi ì¤‘ ì–´ëŠ ê±¸ ì„ íƒí•´ì•¼ í•  ì§€,
     ì •ë‹µì´ loì¸ì§€ hiì¸ì§€ (lo + hi) / 2ì¸ì§€ ëª¨ë¥´ê² ê³ ,
     ì‹¬ì§€ì–´ whileë¬¸ì´ ëë‚˜ì§€ ì•Šì•„ì„œ 'ì‹œê°„ì´ˆê³¼'ê°€ ëœ¨ê¸°ë„ í•©ë‹ˆë‹¤.

`1. í—·ê°ˆë¦¬ì§€ ì•Šê²Œ êµ¬í˜„í•˜ëŠ” ë°©ë²• `

`2. ì´ë¶„íƒìƒ‰ì˜ ëŒ€í‘œì  ì‘ìš©ì¸ lower_bound, upper_bound`

### ìŠì§€ ë§ì•„ì•¼í•  Computer Science ë¬¸ì œ í•´ê²° ê·œì¹™

1. ì‚¬ìš©ëœ ì•Œê³ ë¦¬ì¦˜ì´ ì ì ˆí•œê°€? (ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ”ê°€?)
2. íš¨ìœ¨ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ê°€?

</br>

## 2. ì„¸ ì¤„ ìš”ì•½

    1. [lo, hi]ê°€ Check(lo) != Check(hi)ê°€ ë˜ë„ë¡ êµ¬ê°„ì„ ì„¤ì •

    2. while (lo + 1 < hi)ë™ì•ˆ mid = (lo + hi) / 2ì—ì„œ Check(mid) = Check(lo)ë¼ë©´ lo = mid, ì•„ë‹ˆë¼ë©´ hi = mid

    3. êµ¬í•œ ê²½ê³„ì—ì„œ ë‹µì´ loì¸ì§€ hiì¸ì§€ ìƒê°í•´ë³´ê³  ì¶œë ¥

    (1ì—ì„œ ê²½ê³„ëŠ” í•­ìƒ [lo, hi] ë‚´ì— ì¡´ì¬í•˜ê³ ,
     2ì—ì„œ Check(lo), Check(hi)ëŠ” ë³€í•˜ì§€ ì•Šìœ¼ë©°,
     3ì—ì„œ lo + 1 >= hi ì´ê³ , lo < mid < hi ì—ì„œ lo < hi ì´ë¯€ë¡œ lo == hi ë¥¼ ë§Œì¡±í•¨)

## 3 .ì´ë¶„ íƒìƒ‰ì´ë€?

    ê²°ì •ë¬¸ì œ(Decision Problem)ì˜ ë‹µì´ ì´ë¶„ì ì¼ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íƒìƒ‰ê¸°ë²•

- `ê²°ì • ë¬¸ì œ`ë€ `ë‹µì´ YES or NOì¸ ë¬¸ì œ` ë¥¼ ì˜ë¯¸í•¨.

- ì´ë¶„íƒìƒ‰ì˜ ë¬¸ì œì—ì„œëŠ” ë³´í†µ 1ê°œì˜ parameterë¥¼ ê°€ì§.

### ì˜ˆì‹œ

`1~50 ê¹Œì§€ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ëœ ì¹´ë“œ ë”ë¯¸ì—ì„œ 28ë²ˆ ì¹´ë“œë¥¼ ì°¾ëŠ” ë¬¸ì œ`ë¥¼ ì˜ˆì‹œë¡œ ì´ë¶„ íƒìƒ‰ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. í¸ì˜ìƒ ì²« ë²ˆì§¸ ì¹´ë“œë¶€í„° `ië²ˆì§¸ ì¹´ë“œëŠ” v[i]`, `28ì€ var`ë¡œ í‘œê¸°í•˜ê² ìŠµë‹ˆë‹¤.

ì´ë•Œ ê²°ì • ë¬¸ì œë¥¼ "v[i] >= val ì¸ê°€?" ë¡œ ì¡ìœ¼ë©´ ê²°ì • ë¬¸ì œì˜ ë‹µì€ iê°€ ì¦ê°€í•¨ì— ë”°ë¼ F, F, F, ..., T, T, ...Tì™€ ê°™ì´ ë¶„í¬í•©ë‹ˆë‹¤. ìš°ë¦¬ê°€ ì°¾ê³ ì í•˜ëŠ” ê°’ì€ ì²˜ìŒìœ¼ë¡œ v[i] >= val ì§€ì , ì¦‰ ì²˜ìŒ ê²°ì • ë¬¸ì œê°€ Trueê°€ ë˜ëŠ” iê°’ì…ë‹ˆë‹¤.

ì´ë ‡ê²Œ ê²°ì • ë¬¸ì œì˜ parameter(i) ì— ëŒ€í•´ ê²°ì • ë¬¸ì œì˜ ë‹µì´ ë‘ êµ¬ê°„ìœ¼ë¡œ ë‚˜ë‰˜ëŠ” ê²ƒì„ `ì´ë¶„ì ì´ë‹¤` ë¼ê³  í•˜ë©°,

ì´ëŸ° ê²½ìš° ì´ë¶„ íƒìƒ‰ì„ ì‚¬ìš©í•´ ê²°ì • ë¬¸ì œì˜ ë‹µì´ ë‹¬ë¼ì§€ëŠ” ê²½ê³„ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì´ë¶„ íƒìƒ‰ì˜ ì•„ì´ë””ì–´

    ê²½ê³„ë¥¼ í¬í•¨í•˜ëŠ” êµ¬ê°„[lo, hi]ë¥¼ ì¡ì€ ë’¤ êµ¬ê°„ì˜ ê¸¸ì´ë¥¼ ì ˆë°˜ì”© ì¤„ì—¬ë‚˜ê°€ë©° lo, hiì´ ê²½ê³„ ì§€ì ì— ìœ„ì¹˜í•˜ë„ë¡ í•˜ëŠ” ê²ƒ

ì´ë¶„íƒìƒ‰ì´ ëë‚œ ë’¤ì—ëŠ” loì˜ ë‹¤ìŒ ì¹¸ì€ hi(ì¦‰, lo + 1 == hi)ì´ë©° Check(lo) != Check(hi)ì…ë‹ˆë‹¤. ì´ë•Œ Check(x)ëŠ” ê²°ì • ë¬¸ì œì˜ parameterê°€ xì¼ ë•Œ ê²°ì • ë¬¸ì œì˜ ë‹µì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ìœ„ ì˜ˆì‹œì—ì„œ [1, 50] â†’ [25, 50] â†’ ... â†’ [27, 28]ë¡œ lo, hië¥¼ ì¤„ì—¬ë‚˜ê°„ ë’¤ `hi = 28` ë¥¼ ì°¾ì•„ì£¼ë©´ ë©ë‹ˆë‹¤. ì´ë¶„ íƒìƒ‰ì€ `êµ¬ê°„ì˜ ë²”ìœ„ê°€ í´ ë•Œ íŠ¹íˆ íš¨ê³¼ì `ì…ë‹ˆë‹¤. ë§Œì•½ `ì¹´ë“œê°€ 100ë§Œì¥`ì´ë¼ê³  í•˜ë©´, `2^20 >= 1,000,000`ì´ê¸° ë•Œë¬¸ì— `ìµœëŒ€ 20ë²ˆì˜ ì—°ì‚°`ìœ¼ë¡œ ì›í•˜ëŠ” ì¹´ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 4. êµ¬í˜„ ë°©ë²• - `1. í—·ê°ˆë¦¬ì§€ ì•Šê²Œ êµ¬í˜„í•˜ëŠ” ë°©ë²• `

1.  Check(lo) != Check(hi) ê°€ ë˜ë„ë¡ lo, hiì˜ ì´ˆê¹ƒê°’ì„ ì˜ ì„¤ì •

2.  `lo + 1 < hi`ì¸ ë™ì•ˆ `mid = (lo + hi)/2` ë¥¼ êµ¬í•˜ê¸°

3.  Check(`lo`) == Check(`mid`)ë¼ë©´ `lo = mid`ë¥¼,
4.  Check(`hi`) == Check(`mid`)ë¼ë©´ `hi = mid`ë¥¼ í•´ì£¼ë©´ ë¨

    - ìš°ì„  ì´ˆê¸° ìƒíƒœì˜ lo, hiê°€ Check(lo) != Check(hi)ì´ê¸° ë•Œë¬¸ì— ê²°ì • ë¬¸ì œì˜ ë‹µì´ ë°”ë€ŒëŠ” ê²½ê³„ëŠ” [lo, hi] ë‚´ì— ìˆìŒì´ ë³´ì¥ë¨

5.  lo + 1 < hi ì¸ ë™ì•ˆ [lo, hi]ë¥¼ [lo, mid] ë˜ëŠ” [mid, hi]ë¡œ ì¤„ì—¬ ë‚˜ê°€ëŠ”ë°, ì´ ê²½ìš° Check(lo), Check(hi)ëŠ” ë°”ë€Œì§€ ì•ŠìŒ

        âˆµ Check(lo) == Check(mid)ë¼ë©´ `lo = mid`ë¥¼, Check(hi) == Check(mid)ë¼ë©´ `hi = mid`ë¥¼ í•˜ê¸° ë•Œë¬¸

6.  ë˜í•œ lo + 1 < hi ì´ê¸° ë•Œë¬¸ì— loì™€ hi ì‚¬ì´ì—ëŠ” ë¬´ì¡°ê±´ í•œ ê°œ ì´ìƒì˜ ì¹¸ì´ ìˆìœ¼ë©°, mid ëŠ” í•­ìƒ lo < mid < hi ë¥¼ ë§Œì¡±

        âˆ´ êµ¬ê°„ì˜ ê¸¸ì´ : ë§¤ë²ˆ ì ˆë°˜ì”© ì¤„ì–´ë“¤ë©°, ì–¸ì  ê°„ lo + 1 == hiê°€ ë˜ì–´ì„œ ë°˜ë³µë¬¸ íƒˆì¶œ

(`ë°˜ë³µë¬¸ì„ íƒˆì¶œí–ˆë‹¤ë©´ lo + 1 >= hi` ì¸ë° `lo < mid < hiì¸ midë¥¼ ëŒ€ì…`í•˜ê¸° ë•Œë¬¸ì— `lo < hi` ì´ê³ , `ë‘ ì¡°ê±´ì„ ë§Œì¡±`í•˜ëŠ” lo, hiëŠ” `lo + 1 == hiì¸ ê²½ìš° ë°–ì— ì—†ìŒ`)

### â†’ ğŸˆ ì´ë¶„ íƒìƒ‰ì´ ëë‚˜ë©´ lo, hiëŠ” ê²°ì • ë¬¸ì œì˜ ë‹µì´ ë°”ë€ŒëŠ” ê²½ê³„ì— ìœ„ì¹˜í•¨

### â†’ ğŸˆ ë§Œì•½ ê²°ì • ë¬¸ì œ ë‹µì˜ ë¶„í¬ê°€ F~Tì¸ë° ì •ë‹µì´ `ê°€ì¥ í° Fë¼ë©´ lo`ë¥¼, `ê°€ì¥ ì‘ì€ Të¼ë©´ hi`ë¥¼ ì¶œë ¥í•´ì£¼ë©´ ë¨.

<br>

## 5. ì‹œê°í™”ëœ ìë£Œ

### 1. ê²½ê³„ë¥¼ í¬í•¨í•˜ë„ë¡, ì¦‰ Check(lo) != Check(hi)ê°€ ë˜ë„ë¡ [lo, hi]ë¥¼ ì¡ìŒ

![Alt text](image.png)

2. Check(lo) == midë¼ë©´ lo = mid, ì•„ë‹ˆë¼ë©´ hi = midë¥¼ ë°˜ë³µ

![Alt text](image-1.png)![Alt text](image-2.png)

3. lo + 1 == hiê°€ ë˜ë©´ íƒˆì¶œ, lo, hiëŠ” ê²½ê³„ì— ìœ„ì¹˜

![Alt text](image-3.png)

<br>

## 6. `2. ì´ë¶„íƒìƒ‰ì˜ ëŒ€í‘œì  ì‘ìš©ì¸ lower_bound, upper_bound`

### ì´ë¶„íƒìƒ‰ì´ ì‚¬ìš©ë˜ëŠ” ëŒ€í‘œì ì¸ ì˜ˆì‹œ

- ì •ë ¬ëœ ë°°ì—´ì—ì„œ íŠ¹ì • ê°’ ì´ìƒ ë˜ëŠ” ì´ˆê³¼ì¸ ì›ì†Œê°€ ë“±ì¥í•˜ëŠ” ì²˜ìŒ ìœ„ì¹˜ë¥¼ ì°¾ëŠ” ë¬¸ì œ

ì´ëŠ” `cppë¥¼ ê¸°ì¤€`ìœ¼ë¡œ `algorithm í—¤ë”`ì— `std::lower_bound`, `std::upper_bound`ë¼ëŠ” í•¨ìˆ˜ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŒ

```C++
#include <iostream>
#include <algorithm>
#include <vector>

int main() {
    std::vector<int> vec = {1, 2, 4, 4, 5, 6, 7};

    // lower_bound ì‚¬ìš© ì˜ˆì‹œ
    auto lower = std::lower_bound(vec.begin(), vec.end(), 4);
    std::cout << "Lower Bound: " << std::distance(vec.begin(), lower) << std::endl;

    // upper_bound ì‚¬ìš© ì˜ˆì‹œ
    auto upper = std::upper_bound(vec.begin(), vec.end(), 4);
    std::cout << "Upper Bound: " << std::distance(vec.begin(), upper) << std::endl;

    return 0;
}
```

<br>

1.  lower_bound

        v[i-1] < k <= v[i]ì¸ ië¥¼ ì°¾ì•„ì£¼ëŠ” í•¨ìˆ˜

        v[i] >= k ì¸ iì˜ ìµœì†Ÿê°’ì„ ë°˜í™˜

        ë§Œì•½, vì˜ ëª¨ë“  ì›ì†Œê°€ kë³´ë‹¤ 'ì‘ë‹¤ë©´' vì˜ ë§ˆì§€ë§‰ ë‹¤ìŒ ì¹¸ì˜ ìœ„ì¹˜ ë°˜í™˜

2.  upper_bound

        v[i-1] <= k < v[i]ì¸ ië¥¼ ì°¾ì•„ì£¼ëŠ” í•¨ìˆ˜

        v[i] > kì¸ iì˜ ìµœì†Ÿê°’ì„ ë°˜í™˜

        ë§Œì•½, vì˜ ëª¨ë“  ì›ì†Œê°€ kë³´ë‹¤ 'ì‘ê±°ë‚˜ ê°™ë‹¤ë©´' vì˜ ë§ˆì§€ë§‰ ë‹¤ìŒ ì¹¸ì˜ ìœ„ì¹˜ ë°˜í™˜

### lower_bound, upper_bound êµ¬í˜„ (Python.ver)

```python
def lower_bound(arr, x):
    lo, hi = -1, len(arr)
    while lo + 1 < hi:
        mid = (lo + hi) // 2
        if not (arr[mid] >= x):
            lo = mid
        else:
            hi = mid
    return hi

def upper_bound(arr, x):
    lo, hi = -1, len(arr)
    while lo + 1 < hi:
        mid = (lo + hi) // 2
        if not (arr[mid] > x):
            lo = mid
        else:
            hi = mid
    return hi

v = [1, 2, 3, 3, 4]
print(lower_bound(v, 3))  # 2
print(upper_bound(v, 3))  # 4
print(upper_bound(v, 3) - lower_bound(v, 3))  # 2
```

## P.S. Python ì´ì§„ íƒìƒ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬

`bisect` : ì´ì§„ íƒìƒ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬(ëª¨ë“ˆ) ì§€ì›

`ì •ë ¬ëœ ë¦¬ìŠ¤íŠ¸` ì—ì„œ `ê°’ì´ íŠ¹ì • ë²”ìœ„ì— ì†í•˜ëŠ” ì›ì†Œì˜ ê°œìˆ˜` ë¥¼ êµ¬í•  ë•Œ ì‚¬ìš©í•˜ë©´ íš¨ìœ¨ì 

- bisect_left(a, x) --> ì •ë ¬ëœ ìˆœì„œë¥¼ ìœ ì§€í•˜ë©´ì„œ ë¦¬ìŠ¤íŠ¸ aì— ë°ì´í„° xë¥¼ ì‚½ì…í•  ê°€ì¥ ì™¼ìª½ indexë¥¼ ì°¾ëŠ” method

- bisect_right(a, x) --> ì •ë ¬ëœ ìˆœì„œë¥¼ ìœ ì§€í•˜ë„ë¡ ë¦¬ìŠ¤íŠ¸ aì— ë°ì´í„° xë¥¼ ì‚½ì…í•  ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ë¥¼ ì°¾ëŠ” ë©”ì†Œë“œ

```python
from bisect import bisect_left, bisect_right
a = [1, 2, 4, 4, 8]
x = 4

print(bisect_left(a, x))
>>> 2
# ë¦¬ìŠ¤íŠ¸ aì— 4ë¥¼ ì‚½ì…í•  ê°€ì¥ ì™¼ìª½ ì¸ë±ìŠ¤ = 2

print(bisect_right(a, x))
>>> 4
# ë¦¬ìŠ¤íŠ¸ aì— 4ë¥¼ ì‚½ì…í•  ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ = 4
```
